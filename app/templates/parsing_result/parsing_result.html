{% extends 'base.html' %}

{% if parametrs.jobs is not none %}

{% block PARSINGRESULTPAGE %} active {% endblock %}

{% block save %}
    <li class="nav-item">
        <a class="nav-link" href="{{ url_for('blueprint_parsing_result.add_parsing_vacancies', param='all') }}">
            Add all
        </a>
    </li>
    <li class="nav-item">
        <a class="nav-link" href="{{ url_for('blueprint_parsing_result.add_parsing_vacancies', param='favorites') }}">
            Add favorites
        </a>
    </li>
    <li class="nav-item">
        <a class="nav-link" href="{{ url_for('blueprint_parsing_result.delete_vacancies') }}">
            Delete all
        </a>
    </li>
{% endblock %}

{% block page_content %}
<meta name="csrf-token" content="{{ csrf_token() }}">
    <div class="container col-12" style="margin-top:15px;">
        <table class="table table-striped table-hover border">
            <thead>
            <tr>
                <td align="center" colspan="7">
                <b>Parsing results found {{ parametrs.count }}
                    {% if parametrs.count == 1 %}
                        job.
                    {% else %}
                        jobs.
                    {% endif %}
                    {% if parametrs.paginate %}
                        Showing page {{ parametrs.jobs.page }} of {{ parametrs.jobs.pages }}.
                    {% endif %}
                </b>
                </td>
            </tr>
            <tr>
                <th>Title</th>
                <th>Company</th>
                <th>Salary</th>
                <!--<th>Location</th>-->
                <th>City</th>
                <th>State</th>
                <th>Link</th>
                <th>Favorites</th>
                <th>Action</th>

            </tr>
            </thead>
            <tbody>
            {% if parametrs.paginate %}
            {% for job in parametrs.jobs.items %}
            <tr>
                <td>{{ job.title }}</td>
                <td>{{ job.company }}</td>
                <td>{{ job.salary }}</td>
                <!--<td>{{ job.location }}</td>-->
                <td>{{ job.city }}</td>
                <td>{{ job.state }}</td>
                <td><a class="text-muted" href="{{ job.link }}" target="_blank">Open</a></td>
                <td>
                <div class="custom-control custom-switch col">
                    <input id="{{job.id}}"
                           class="custom-control-input"
                           type="checkbox" 
                           {% if job.status %}checked="y"{% endif %}
                           onclick="status_temp_vacancy({{job.id}})">
                    <label class="custom-control-label" for="{{job.id}}">Favorite</label>
                </div>
                </td>
                <td>
                <input type="button"
                       class="btn btn-outline-secondary"
                       value="delete"
                       onclick="delete_vacancy({{job.id}})">
                </td>

            </tr>
            {% endfor %}
            {% else %}
            {% for job in parametrs.jobs %}
            <tr>
                <td>{{ job.title }}</td>
                <td>{{ job.company }}</td>
                <td>{{ job.salary }}</td>
                <!--<td>{{ job.location }}</td>-->
                <td>{{ job.city }}</td>
                <td>{{ job.state }}</td>
                <td><a class="text-muted" href="{{ job.link }}" target="_blank">Open</a></td>
                <td>
                <div class="custom-control custom-switch">
                    <input id="{{job.id}}"
                           class="form-check-input"
                           type="checkbox" 
                           {% if job.status %}checked="y"{% endif %}
                           onclick="status_temp_vacancy({{job.id}})">
                    <label class="custom-control-label" for="{{job.id}}">Favorite</label>
                </div>
                </td>
                <td>
                <input type="button"
                       class="btn btn-outline-secondary"
                       value="delete"
                       onclick="delete_vacancy({{job.id}})">
                </td>

            </tr>
            {% endfor %}
            {% endif %}
            </tbody>
        </table>
        {% if parametrs.paginate %}{% include 'parsing_result/paginator_parsing_result.html' %}{% endif %}
    </div><br>

{% endblock %}

{% block script %}
<script src="{{ url_for('static', filename='js/parsing_result.js') }}"></script>
{% endblock %}

{% endif %}
